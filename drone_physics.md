# 드론 물리 법칙 정리
```
<inertial> 

    <origin rpy="0 0 0" xyz="0 0 0"/> # 이 물체의 질량 중심(Center of Mass, CoM) 위치와 방향을 정의.  
    -> 드론 전체의 “몸통”으로 모든 좌표 계산의 기준

    <mass value="0.027"/>  * 해당 링크의 무게(kg 단위).

    <inertia ixx="1.4e-5" ixy="0.0" ixz="0.0"   
             iyy="1.4e-5" iyz="0.0" izz="2.17e-5"/> # ixx, iyy, izz → 각 축(X, Y, Z)에 대한 회전 관성 ,
                                              ixy, ixz, iyz → 축 사이의 관성 결합(드론 구조가 대칭이라 0) 
  
</inertial>
```

## 1. 시뮬레이터의 기본 원리

드론 시뮬레이션 엔진(Genesis, MuJoCo, Gazebo 등)은 매 시뮬레이션 스텝마다 **뉴턴–오일러 방정식**을 사용

- **병진 운동 (Translation Motion)**  
m·a = F_ext


- **회전 운동 (Rotational Motion)**  
I·α + ω × (I·ω) = τ_ext  



>- m : 질량 — URDF `<mass>`  
>- I : 관성 텐서 — URDF `<inertia>`  
>- ext = external

---

## 2. 드론에 어떻게 적용되나?

### (1) 병진 운동

드론의 각 모터가 만드는 추력 Fᵢ는 시뮬레이터에서 합산됨:

F_total = Σᵢ₌₁⁴ Fᵢ + F_gravity + F_drag  

이를 병진 운동 방정식에 대입하면:

a = F_total / m  

>- m : URDF `<mass>` 값  
>- a : 질량 중심(CoM)의 가속도 (드론 몸통 전체 움직임)  
>- `<origin>` : CoM의 위치를 정의 → 어떤 점이 기준인지 결정  

 **Force Drag (F_drag)**  
- 드론이 공기 중을 움직일 때 생기는 공기 저항  

F_drag = −k_d · v  

- k_d : 선형 저항 계수  
- v : 드론 속도  

-> 드론이 앞으로 빨리 나가면 반대 방향으로 힘이 작용  


---

### (2) 회전 운동

모터 추력은 CoM에서 떨어진 위치 때문에 토크를 만들어냄:

τ_ext = Σᵢ₌₁⁴ ( rᵢ × Fᵢ ) + τ_drag  

- rᵢ : CoM에서 i번째 프로펠러까지의 위치 벡터 (URDF `<origin>` 좌표)  
- Fᵢ : i번째 프로펠러 추력  
- τ_drag : 프로펠러 반작용 항력 토크  

이를 회전 운동 방정식에 대입:

I·α = τ_ext − ω × (I·ω)  
 
>- I : URDF `<inertia>`에서 불러온 관성 텐서  
>- α : 각가속도 (드론이 얼마나 빨리 회전 속도를 바꾸는지)  
>- ω : 현재 각속도  

**Torque Drag (τ_drag)**  
- 프로펠러가 회전할 때 공기를 밀어내며 생기는 반작용 토크  

τ_drag,i = k_m · ωᵢ²  

- k_m : 항력 토크 계수  
- ωᵢ : 모터 각속도  

>-> 모든 프로펠러가 같은 방향으로 돌면 드론 전체가 빙빙 돌게 됨  
-> 그래서 쿼드콥터는 프로펠러를 반대 방향으로 짝수 개 배치해 상쇄  

---

##  3. 모터 RPM → 추력 변환

프로펠러 추력은 보통 **제곱 법칙(quadratic law)**으로 모델링함:

Fᵢ = k_f · ωᵢ²  

- Fᵢ : i번째 프로펠러 추력 (N)  
- ωᵢ : 프로펠러 각속도 (rad/s)  
  ωᵢ = (2π / 60) · RPMᵢ  
- k_f : 추력 상수 (실험으로 얻는 값)  

> 왜 제곱을 할까?  
프로펠러가 공기를 밀어내는 힘은 유체 속도²에 비례 → RPM이 2배면 추력은 약 4배 증가  

---


## 4. 실제 시뮬레이션 흐름

1. 모터 RPM 입력 → 각속도 변환 (ωᵢ)  
2. ωᵢ² → 추력 Fᵢ 계산  
3. 4개 추력 + 중력 + 드래그 → 합력 F_total  
4. 병진 운동 방정식 → 가속도 a 적분, 위치/속도 업데이트  

- vₜ₊₁ = vₜ + a·Δt  
- xₜ₊₁ = xₜ + vₜ₊₁·Δt  

5. 추력 + 위치 벡터 외적 → 모멘트(토크) 계산  
6. 회전 운동 방정식 → 각가속도 α 적분, 각속도/자세 업데이트  

- ωₜ₊₁ = ωₜ + α·Δt  
- Rₜ₊₁ = Rₜ · exp([ ωₜ₊₁·Δt ]ₓ)  

여기서 [·]ₓ 는 벡터의 외적(cross product)

---

## 최종 요약

- `<mass>` : 힘 → 가속도로 변환 (a = F / m)  
- `<origin>` : 질량 중심(CoM) 좌표 → 힘·토크 계산 기준점  
- `<inertia>` : 관성 텐서 → 토크 → 각가속도 변환 (α = I⁻¹·τ)  
- 추력 Fᵢ : 모터 RPM²에 비례 → Fᵢ = k_f · ωᵢ²  
- Force drag : 이동 속도에 비례하는 저항 (−k_d · v)  
- Torque drag : 모터 회전에 비례하는 반작용 토크 (k_m · ω²)  

>-> 시뮬레이터는 이 값들을 매 시뮬레이션 스텝마다 적용해  
**드론의 위치·속도(병진)**과 **자세·각속도(회전)**를 업데이트함.
